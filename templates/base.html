<!DOCTYPE html> 
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>{% block title %}{% endblock title %} | AHMED ICE CREAMS</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark " style="background: linear-gradient(135deg, #ff6b9d 0%, #d6336c 100%);">
    <div class="container-fluid">
      <a class="navbar-brand" href="{% url 'home' %}" style="font-family: 'Pacifico', cursive; color: #ffffff;">AHMED ICE CREAMS</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse justify-content-between" id="navbarNavDropdown">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link active" href="{% url 'home' %}">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="/about">About Us</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link active dropdown-toggle" href="/services" role="button" data-bs-toggle="dropdown">
              Services
            </a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="/services">Custom Ice Cream Orders</a></li>
              <li><a class="dropdown-item" href="/services">Birthday Parties</a></li>
              <li><a class="dropdown-item" href="/services">Wedding Catering</a></li>
              <li><a class="dropdown-item" href="/services">Corporate Events</a></li>
              <li><a class="dropdown-item" href="/services">Bulk Orders</a></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item" href="{% url 'book_services' %}">
                <i class="fas fa-calendar-check me-2"></i>Book Our Services
              </a></li>
            </ul>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="/contact">Contact Us</a>
          </li>
        </ul>
        
        <!-- Right Side Layout -->
        <div class="d-flex align-items-center mobile-vertical-container">
          <!-- Search Form -->
          <form class="d-flex me-3 search-form-container" role="search" action="{% url 'home' %}" method="GET">
            <input class="form-control me-2" type="search" placeholder="Search Flavors..." name="q" value="{{ query|default:'' }}" aria-label="Search">
            <button class="btn btn-outline-light" type="submit">Search</button>
          </form>

          

          <!-- Auth Links -->
          <div class="ms-1 auth-buttons-container">
            <!-- Auth Links â€“ dropdown version (replace the old <div class="ms-1 auth-buttons-container">  -->
{% if user.is_authenticated %}
<div class="dropdown ms-1">
  <button class="btn btn-outline-light btn-sm dropdown-toggle d-flex align-items-center"
          type="button" id="userMenu"
          data-bs-toggle="dropdown" aria-expanded="false">
      <i class="fas fa-user me-1"></i>{{ user.first_name|default:user.username }}
  </button>

  <ul class="dropdown-menu dropdown-menu-end shadow-sm" aria-labelledby="userMenu">
      <li>
          <a class="dropdown-item d-flex align-items-center" href="{% url 'my_activity' %}">
              <i class="fas fa-history me-2 text-primary"></i>My Activity
          </a>
      </li>
        <li>
          <a class="dropdown-item d-flex align-items-center justify-content-between"
       href="{% url 'cart' %}">
        <span>
            <i class="fas fa-shopping-cart me-2 text-warning"></i>My Cart
        </span>
        {% if cart_item_count|default:0 > 0 %}
        <span class="badge bg-danger rounded-pill ms-2">
            {{ cart_item_count }}
        </span>
        {% endif %}
    </a>
      </li>
      <li><hr class="dropdown-divider"></li>
      <li>
          <a class="dropdown-item d-flex align-items-center text-danger" href="{% url 'logout' %}">
              <i class="fas fa-sign-out-alt me-2"></i>Logout
          </a>
      </li>
  </ul>
</div>
{% else %}
<div class="auth-buttons-container ms-1">
  <a href="{% url 'login' %}"    class="btn btn-outline-success btn-sm">Login</a>
  <a href="{% url 'register' %}" class="btn btn-primary btn-sm ms-2">Sign Up</a>
</div>
{% endif %}
<!--  end Auth Links  -->

          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- Fixed Styles -->
 <style>
    /* Reset and Base Styles for Mobile Clarity */
   
    * {
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
      box-sizing: border-box;
    }

    html {
      -webkit-text-size-adjust: 100%;
      -ms-text-size-adjust: 100%;
      font-size: 16px;
      /* ADDED: Fix viewport and overflow issues */
      width: 100%;
      overflow-x: hidden; /* Prevents horizontal scroll */
      position: relative;
    }

    body {
      font-family: 'Poppins', sans-serif;
      font-weight: 400;
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
      /* ADDED: Fix viewport and overflow issues */
      width: 100%;
      overflow-x: hidden;
      position: relative;
    }

    /* ADDED: Ensure main container doesn't exceed viewport */
    .container, .container-fluid {
      max-width: 100%;
      padding-left: 15px;
      padding-right: 15px;
      margin-left: auto;
      margin-right: auto;
    }

    /* ADDED: Fix carousel container */
    .hero-carousel {
      position: relative;
      width: 100%;
      max-width: 100%;
      overflow: hidden; /* Prevents content spillover */
    }

    .carousel-inner {
      width: 100%;
      overflow: hidden;
    }

    .carousel-item {
      width: 100%;
      max-width: 100%;
    }

    /* ADDED: Fix carousel caption positioning */
    .carousel-caption {
      position: absolute;
      left: 50%;
      transform: translateX(-50%); /* Center horizontally */
      width: 90%;
      max-width: 400px;
    }

    /* Navbar Styles */
    .navbar-brand {
      font-size: 1.2rem;
      font-weight: 600;
    }

    .nav-link {
      font-size: 0.95rem;
      font-weight: 500;
    }

    .btn {
      font-size: 0.9rem;
      font-weight: 500;
    }

    .navbar-text {
      font-size: 0.9rem;
      font-family: 'Poppins', sans-serif;
    }

    /* Mobile Styles */
    @media (max-width: 991.98px) {
      /* Mobile navbar background fix */
      .navbar-collapse {
        background: linear-gradient(135deg, #ff6b9d 0%, #d6336c 100%) !important;
        border-radius: 15px;
        margin-top: 1rem;
        padding: 1.5rem;
        box-shadow: 0 8px 25px rgba(214, 51, 108, 0.3);
      }

      /* Mobile typography */
      .navbar-brand {
        font-size: 1.1rem;
      }
      
      .nav-link {
        font-size: 1rem;
        padding: 0.8rem 1rem;
        font-weight: 500;
      }
      
      .btn {
        font-size: 0.95rem;
        font-weight: 500;
      }

      /* Mobile layout fixes */
      .mobile-vertical-container {
        flex-direction: column !important;
        align-items: stretch !important;
        width: 100%;
        gap: 1rem;
        margin-top: 1.5rem;
        padding-top: 1rem;
        border-top: 1px solid rgba(255, 255, 255, 0.2);
      }

      .search-form-container {
        width: 100% !important;
        margin: 0 !important;
        margin-bottom: 0.5rem !important;
      }

      .search-form-container .form-control {
        flex: 1;
        font-size: 1rem;
      }

      .search-form-container .btn {
        white-space: nowrap;
        padding: 0.6rem 1rem;
        font-size: 0.95rem;
      }

      .cart-button {
        width: 100% !important;
        margin: 0 !important;
        margin-bottom: 0.5rem !important;
        text-align: center;
        padding: 0.8rem;
        font-size: 1rem;
      }

      .auth-buttons-container {
        width: 100% !important;
        margin: 0 !important;
        display: flex !important;
        flex-direction: column !important;
        align-items: stretch !important;
        gap: 0.5rem;
      }

      .user-welcome {
        width: 100% !important;
        text-align: center !important;
        margin: 0 !important;
        margin-bottom: 0.5rem !important;
        padding: 0.6rem;
        background: rgba(255, 255, 255, 0.15);
        border-radius: 8px;
        font-size: 1rem;
      }

      .auth-buttons-container .btn {
        width: 100% !important;
        margin: 0 !important;
        text-align: center;
        padding: 0.8rem;
        font-size: 1rem;
      }

      .auth-buttons-container .btn:not(:last-child) {
        margin-bottom: 0.5rem !important;
      }
    }

    /* ADDED: Fix for mobile zoom and orientation */
    @media (max-width: 768px) {
      /* Prevent zoom issues */
      .hero-carousel {
        width: 100vw;
        max-width: 100vw;
        margin-left: calc(-50vw + 50%);
        margin-top: 0;
        padding-top: env(safe-area-inset-top, 0px); /* For notched phones */
      }
      
      .carousel-caption {
        left: 50%;
        transform: translateX(-50%);
        width: 85%;
        padding: 1rem;
        bottom: 8%;
      }
    }

    /* Extra small devices */
    @media (max-width: 575.98px) {
      .navbar-brand {
        font-size: 1rem;
      }
      
      .navbar-collapse {
        padding: 1rem;
      }

      .mobile-vertical-container {
        gap: 0.75rem;
      }
    }

    /* ADDED: Specific fix for very small screens */
    @media (max-width: 576px) {
      .carousel-caption {
        width: 88%;
        padding: 0.8rem;
        bottom: 5%;
      }
      
      .carousel-caption h5 {
        font-size: 1.1rem;
        margin-bottom: 0.4rem;
      }
      
      .carousel-caption p {
        font-size: 0.8rem;
        margin-bottom: 0.5rem;
      }
    }

    /* ADDED: Fix for landscape orientation on mobile */
    @media (max-height: 500px) and (orientation: landscape) {
      .carousel-item {
        height: 100vh;
        min-height: 100vh;
      }
      
      .carousel-caption {
        bottom: 2%;
        padding: 0.5rem;
      }
      
      .carousel-caption h5 {
        font-size: 1rem;
      }
      
      .carousel-caption p {
        font-size: 0.75rem;
      }
    }

    /* Remove blur-causing transforms */
    .navbar, .navbar-collapse, .btn, .form-control {
      transform: none !important;
      -webkit-transform: none !important;
      will-change: auto;
    }

    /* User-dropdown tweaks */
    .dropdown-menu{
      border:none;
      border-radius:12px;
      min-width:180px;
    }
    .dropdown-item{
      font-size:0.9rem;
      font-weight:500;
      padding:0.6rem 1rem;
      transition:background 0.2s ease;
    }
    .dropdown-item:hover{
      background:rgba(214,51,108,0.08);
    }

    /* Stack the dropdown button like the other vertical buttons on mobile */
    @media (max-width:991.98px){
      .dropdown .btn{
        width:100%;
        text-align:left;
      }
    }

    /* ADDED: Ensure proper viewport meta tag behavior */
    @viewport {
      width: device-width;
      zoom: 1.0;
    }


/* STICKY NAVIGATION BAR */
.navbar {
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  width: 100% !important;
  z-index: 1030 !important;
  transition: all 0.3s ease !important;
  box-shadow: 0 2px 15px rgba(0,0,0,0.15) !important;
}

/* Add padding to body to prevent content from hiding behind fixed navbar */
body {
  padding-top: 76px !important; /* Adjust based on your navbar height */
}

/* Mobile responsive adjustments for sticky navbar */
@media (max-width: 991.98px) {
  body {
    padding-top: 70px !important; /* Smaller padding for mobile */
  }
  
  /* Ensure mobile navbar collapse doesn't get cut off */
  .navbar-collapse {
    position: absolute !important;
    top: 100% !important;
    left: 0 !important;
    right: 0 !important;
    z-index: 1025 !important;
    max-height: calc(100vh - 70px) !important;
    overflow-y: auto !important;
  }
}

@media (max-width: 575.98px) {
  body {
    padding-top: 65px !important; /* Even smaller for very small mobile */
  }
}

/* Ensure dropdown menus appear above other content */
.dropdown-menu {
  z-index: 1035 !important;
}

/* Optional: Add a subtle animation when page loads */
.navbar {
  animation: slideDown 0.5s ease-out;
}

@keyframes slideDown {
  from {
    transform: translateY(-100%);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}



</style>
<script>
document.addEventListener('DOMContentLoaded', function() {
  const navbar = document.querySelector('.navbar');
  
  window.addEventListener('scroll', function() {
    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
    
    // Add subtle background change when scrolling
    if (scrollTop > 50) {
      navbar.style.background = 'linear-gradient(135deg, #ff6b9d 0%, #d6336c 100%, rgba(0,0,0,0.1))';
      navbar.style.backdropFilter = 'blur(10px)';
    } else {
      navbar.style.background = 'linear-gradient(135deg, #ff6b9d 0%, #d6336c 100%)';
      navbar.style.backdropFilter = 'none';
    }
  });
});
</script>


  <!-- Messages -->
  {% if messages %}
    {% for message in messages %}
      <div class="alert alert-{{ message.tags }} alert-dismissible fade show my-0" role="alert">
        <strong>{{ message }}</strong>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    {% endfor %}
  {% endif %}

  {% block body %}{% endblock body %} 
  
  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
